# Клиент NTP
В рамках данной работы был реализован клиент NTP на Java.
Для реализации использовался [RFC: 5905](https://datatracker.ietf.org/doc/html/rfc5905).

https://github.com/LyashenkoValeria/ClientNTP

## Формат пакета
```
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |LI | VN  |Mode |    Stratum     |     Poll      |  Precision   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Root Delay                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Root Dispersion                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                          Reference ID                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                     Reference Timestamp (64)                  +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                      Origin Timestamp (64)                    +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                      Receive Timestamp (64)                   +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                      Transmit Timestamp (64)                  +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```
## Описание работы
Сетевой протокол времени (NTP) позволяет синхронизировать время на компьютере 
со временем полученным с NTP сервера. 

Клиент отправляет на сервер pool.ntp.org на порт 123 пакет, в котором заполняет:
+ `VN` - 3-битовое целое число, представляющее номер версии NTP. В настоящее время - 4. 
+ `Mode` - 3-битовое целое число, представляющее режим. Клиент имеет режим 3.
+ `Transmit Timestamp` - количество секунд с 1 января 1900 года.

Клиент ожидает от сервера пакет в том же формате. 
При получении пакета клиент фиксирует время получения. 
После этого выполняется вычисление смещения и задержки в обоих направлениях.

Смещение:
```
 theta = 1/2 * [(T2-T1) + (T3-T4)]
```
Задержка в обоих направлениях:
```
delta = (T4-T1) - (T3-T2).
```
+ `T1` - Начальное время (origin timestamp). 
+ `T2` - Время приёма (receive timestamp).
+ `T3` - Время отправки (transmit timestamp).
+ `T4` - Зафиксированное ранее время получения (destination timestamp).

Затем полученный от сервера пакет выводится в терминал.

## Запуск
1. Клонируем репозиторий. 
2. Для запуска клиента в директории `ClientNTP\out\artifacts\ClientNTP_jar` вызываем 
   `java -jar ClientNTP.jar`.